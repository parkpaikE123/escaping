<html lang="ko"
		xmlns:th="http://www.thymeleaf.org" 
        xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
        layout:decorate="~{layout/compliance}">
     <div layout:fragment="contents">
		<div class="reser-zone">
			<div class="reser-img d-flex justify-content-center">
				<img width=200 alt="포스터이미지" th:src="${theme.imagePath}">
			</div>
			<div class="reser-info d-flex mt-4">
				<div class="info-1 text-center mr-4">
					<div>
						<label>예약 날짜</label>
						<br>
					<form id="dateForm">
						<input type="date"
							   id="dateInput"
							   max="2030-06-20"
							   min="2025-05-01">
							   <br>
							   <button type="submit" class="btn btn-info col-4 mt-3 form-control date-btn">날짜 선택</button>
					</form>
					</div>
					<div class="select-time d-none mt-4">
						<label>예약 시간</label>
						<form name="time" method="get" th:action="|/theme/reservation-view?themeId=${theme.id}|">
							<div class="time-box d-flex">
								<input id="time" class="choice-time form-control col-3" name="choiceBtn" type="button" value="12:30" >
								<input id="time" class="choice-time form-control col-3" name="choiceBtn" type="button" value="14:30" >
								<input id="time" class="choice-time form-control col-3" name="choiceBtn" type="button" value="16:30" >
								<input id="time" class="choice-time form-control col-3" name="choiceBtn" type="button" value="18:30" >
								<input id="time" class="choice-time form-control col-3" name="choiceBtn" type="button" value="20:30" >
							</div>
						</form>
					</div>
				</div>
				<div class="info-2">
					<label th:text="|지점명: ${theme.branchName}|">지점명: </label>
					<hr>
					<label id="result">예약 날짜 시간: </label>
					<hr>
					<label th:text="|예약 테마: ${theme.themeName}|">예약 테마: </label>
					<hr>
					<label th:text="|예약자명: ${session.name}|">예약자 명: </label>
					<hr>
					<label th:text="|연락처: ${session.phoneNumber}|">연락처: </label>
					<hr>
					<label>인원: </label>
					<select>
						<option value="none">선택
						<option value="2">2
						<option value="3">3
						<option value="4">4
						<option value="5">5
						<option value="6">6
					</select>
					<hr>
					<label th:text="|결제금액: ${theme.price}원|">결제금액:OOOO원</label>
					<hr>
			<div class="reser-payment">
				<button class="col-3" id="kaobtn" style="background: #fee500; color:#000; border-radius:12px; padding: 10px 20px;">
				결제하기
				</button>
			</div>
				</div>
			</div>
		</div>
	</div>
	<script layout:fragment="script">
		$(function() {
			$("kaobtn").click(function() {
				/**
					결제 버트 클릭 시
					테마이름 가격 등등 필수 정보 입력 유효성체크
				**/
				$.ajax({
					type:"get"
					,url:"/pay/ready"
					,data:{
						payment:"payment"
					}
				});
			});
			$("#dateForm").on("submit", function(e) {
				e.preventDefault();
				let date = $("#dateInput").val();
				let dateYear = Number(date.split("-")[0]);
				let dateMonth = Number(date.split("-")[1]);
				let dateDay = Number(date.split("-")[2]);
				totalDate = dateYear + dateMonth + dateDay;
				
				let today = new Date();   
				let toYear = Number(today.getFullYear()); // 년도
				let toMonth = Number(today.getMonth()) + 1;  // 월
				let toDate = Number(today.getDate());  // 날짜
				let totalToDate = toYear + toMonth + toDate;
				if(totalDate >= totalToDate) {
					$(".select-time").removeClass("d-none");
					$(".date-btn").addClass("d-none");
					return;
				} else{
					alert("유효하지 않은 날짜입니다");
					return;
				}
			});
			
			
		});
	</script>
	
</html>